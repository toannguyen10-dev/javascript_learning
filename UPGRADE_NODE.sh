#!/bin/bash

# Script ƒë·ªÉ upgrade Node.js t·ª´ v12 l√™n v20
# Created: 2025-12-31

echo "=========================================="
echo "üöÄ UPGRADE NODE.JS - H∆Ø·ªöNG D·∫™N CHI TI·∫æT"
echo "=========================================="
echo ""

# Ki·ªÉm tra Node.js version hi·ªán t·∫°i
CURRENT_NODE=$(node -v 2>/dev/null || echo "not installed")
echo "üìå Node.js hi·ªán t·∫°i: $CURRENT_NODE"
echo ""

if [[ $CURRENT_NODE == v12* ]] || [[ $CURRENT_NODE == "not installed" ]]; then
    echo "‚ö†Ô∏è  Node.js version n√†y QU√Å C≈®!"
    echo "‚úÖ C·∫ßn upgrade l√™n Node.js v20 tr·ªü l√™n"
    echo ""
    echo "=========================================="
    echo "C√ÅCH 1: S·ª¨ D·ª§NG NVM (KHUY·∫æN NGH·ªä) ‚ú®"
    echo "=========================================="
    echo ""
    echo "B∆∞·ªõc 1: C√†i ƒë·∫∑t nvm"
    echo "--------------------"
    echo "curl -o- https://raw.githubusercontent.com/nvm-sh/nvm/v0.39.7/install.sh | bash"
    echo ""
    echo "B∆∞·ªõc 2: Load nvm v√†o shell"
    echo "--------------------------"
    echo "export NVM_DIR=\"\$HOME/.nvm\""
    echo "[ -s \"\$NVM_DIR/nvm.sh\" ] && \\. \"\$NVM_DIR/nvm.sh\""
    echo ""
    echo "source ~/.bashrc  # ho·∫∑c source ~/.zshrc"
    echo ""
    echo "B∆∞·ªõc 3: C√†i Node.js v20"
    echo "-----------------------"
    echo "nvm install 20"
    echo "nvm use 20"
    echo "nvm alias default 20"
    echo ""
    echo "B∆∞·ªõc 4: Verify"
    echo "--------------"
    echo "node --version  # Ph·∫£i hi·ªÉn th·ªã v20.x.x"
    echo ""
    echo "=========================================="
    echo "C√ÅCH 2: C√ÄI TR·ª∞C TI·∫æP (Ubuntu/Debian)"
    echo "=========================================="
    echo ""
    echo "# X√≥a Node.js c≈©"
    echo "sudo apt remove nodejs npm"
    echo ""
    echo "# Th√™m NodeSource repository"
    echo "curl -fsSL https://deb.nodesource.com/setup_20.x | sudo -E bash -"
    echo ""
    echo "# C√†i Node.js 20"
    echo "sudo apt-get install -y nodejs"
    echo ""
    echo "# Verify"
    echo "node --version"
    echo ""
    echo "=========================================="
    echo "SAU KHI UPGRADE XONG"
    echo "=========================================="
    echo ""
    echo "cd /home/toan.nguyen10/workspace/learning/javascript_learning"
    echo "npm install  # C√†i l·∫°i dependencies n·∫øu c·∫ßn"
    echo "npm run dev  # Ch·∫°y app"
    echo ""
    echo "M·ªü browser: http://localhost:5173"
    echo ""
else
    echo "‚úÖ Node.js version OK!"
    echo ""
    echo "B·∫°n c√≥ th·ªÉ ch·∫°y app ngay:"
    echo "-------------------------"
    echo "cd /home/toan.nguyen10/workspace/learning/javascript_learning"
    echo "npm run dev"
fi

echo ""
echo "=========================================="
echo "üìö T√†i li·ªáu h∆∞·ªõng d·∫´n chi ti·∫øt:"
echo "   - README.md"
echo "   - INSTALLATION.md"
echo "=========================================="

